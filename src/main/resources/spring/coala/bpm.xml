<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">

	<bean id="taskListener" class="com.zyeeda.coala.bpm.support.TaskStatusChangerListener"/>
	<bean id="executionListener" class="com.zyeeda.coala.bpm.support.ProcessStatusChangerListener"/>
	<bean id="taskHandler" class="com.zyeeda.coala.bpm.support.AddGlobalTaskListenerParseHandler"/>
	<bean id="executionHandler" class="com.zyeeda.coala.bpm.support.AddGlobalExecutionListenerParseHandler"/>

	<bean id="processEngineConfiguration" class="org.activiti.spring.SpringProcessEngineConfiguration"
		p:dataSource-ref="dataSource" p:transactionManager-ref="transactionManager"
		p:databaseSchemaUpdate="false" p:jobExecutorActivate="false" p:history="full"
		p:deploymentResources="classpath:bpmn/example-*.bpmn" >
		<property name="postBpmnParseHandlers">
			<list>
				<ref bean="taskHandler"/>
				<ref bean="executionHandler"/>
			</list>
		</property>
		<property name="configurators">
          <list>
              <bean class="com.zyeeda.coala.bpm.group.GroupConfigurator">
              </bean>
          </list>
        </property>
		<property name="customMybatisMappers">
		  <set>
		    <value>com.zyeeda.coala.bpm.mapper.HistoricTaskMapper</value>
		  </set>
		</property>
<!-- 		<property name="activityFontName" value="宋体"/>
		<property name="labelFontName" value="宋体"/> -->
	</bean>

	<bean id="processEngine" class="org.activiti.spring.ProcessEngineFactoryBean"
		p:processEngineConfiguration-ref="processEngineConfiguration" />

	<bean id="repositoryService" factory-bean="processEngine"
		factory-method="getRepositoryService" />
	<bean id="runtimeService" factory-bean="processEngine"
		factory-method="getRuntimeService" />
	<bean id="formService" factory-bean="processEngine"
		factory-method="getFormService" />
	<bean id="identityService" factory-bean="processEngine"
		factory-method="getIdentityService" />
	<bean id="managementService" factory-bean="processEngine"
		factory-method="getManagementService" />

	<bean id="taskService" class="com.zyeeda.coala.bpm.support.DefaultTaskService" p:processEngine-ref="processEngine" />
	<bean id="historyService" class="com.zyeeda.coala.bpm.support.DefaultHistoryService" p:processEngine-ref="processEngine" />

 	<!-- 以下两个 service 只是用于样例代码 -->
	<bean id="multipleSubprocessService" class="com.zyeeda.coala.example.service.generate.bpm.multiple.impl.MultipleSubprocessServiceImpl" />
	<bean id="multipleUserTaskService" class="com.zyeeda.coala.example.service.generate.bpm.multiple.impl.MultipleUserTaskServiceImpl" />
</beans>
